<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LAMP Diagnostic Analyzer</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
    }
    #canvas {
      display: none;
    }
    #result {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>LAMP Diagnostic Analyzer</h1>
  <input type="file" accept="image/*" onchange="loadImage(event)">
  <br><br>
  <canvas id="canvas"></canvas>
  <div id="result"></div>

  <script>
    function loadImage(event) {
      const image = new Image();
      image.onload = () => {
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");
        canvas.width = image.width;
        canvas.height = image.height;
        ctx.drawImage(image, 0, 0);

        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const results = analyzeColors(imageData);
        displayResults(results);
      };
      image.src = URL.createObjectURL(event.target.files[0]);
    }

    function analyzeColors(imageData) {
      const { data, width, height } = imageData;
      const result = [];

      const tubeCount = 8; // change this depending on how many test tubes you have
      const tubeWidth = Math.floor(width / tubeCount);

      for (let i = 0; i < tubeCount; i++) {
        const xStart = i * tubeWidth;
        let pinkScore = 0;
        let orangeScore = 0;

        for (let y = 0; y < height; y++) {
          for (let x = xStart; x < xStart + tubeWidth; x++) {
            const index = (y * width + x) * 4;
            const r = data[index];
            const g = data[index + 1];
            const b = data[index + 2];

            if (r > 180 && g < 100 && b > 180) pinkScore++;
            else if (r > 200 && g > 100 && b < 100) orangeScore++;
          }
        }

        result.push(pinkScore > orangeScore ? "Pink" : "Orange");
      }

      return result;
    }

    function displayResults(results) {
      const output = document.getElementById("result");
      output.innerHTML = "<h3>Diagnostic Results:</h3><ol>" +
        results.map(res => `<li>${res}</li>`).join("") +
        "</ol>";
    }
  </script>
</body>
</html>
